<ion-view view-title="Home">
  <ion-content>
    <ion-list>
      <ion-item class="item-avatar" ng-controller="HomeCtrl">
        <img src={{user.photoURL}} style="width:40px;height:40px">
        <h2>
          <textarea id="postMessage" style="width:100%" placeholder="Want to post?"></textarea>
        </h2>
        <button class="button button-block button-positive col col-25 post" ng-click="doPost()">Post!</button>
      </ion-item>
      <ion-item class="padding" ng-controller="ImageCtrl">
        <ion-item class="item-icon-left">
          <i class="icon ion-plus-circled" ng-click="addImage()"></i>
          Add a photo
        </ion-item>
        <br><br>
        <ion-scroll>
          <div class="row" ng-repeat="image in images" ng-if="$index % 4 === 0">
            <div class="col col-25" ng-if="$index < images.length">
              <img ng-src="data:image/png;base64,{{images[$index]}}" width="100%" />
            </div>
            <div class="col col-25" ng-if="$index + 1 < images.length">
              <img ng-src="data:image/png;base64,{{images[$index + 1]}}" width="100%" />
            </div>
            <div class="col col-25" ng-if="$index + 2 < images.length">
              <img ng-src="data:image/png;base64,{{images[$index + 2]}}" width="100%" />
            </div>
            <div class="col col-25" ng-if="$index + 3 < images.length">
              <img ng-src="data:image/png;base64,{{images[$index + 3]}}" width="100%" />
            </div>
          </div>
        </ion-scroll>
      </ion-item>
      <br>
      <div ng-repeat="post in postsList | orderBy:'-'">
        <br>
        <ion-item class="item-avatar">
          <img src={{post.photoURL}}>
          <h2>{{post.displayName}}</h2>
          <p>{{post.time}}</p>
        </ion-item>
        <ion-item class="item-body">
          <p>
            {{post.message}}
          </p>
          <div ng-repeat="image in parseJSON(post.images)">
            <img class="full-image" ng-src="data:image/png;base64,{{image}}" width="100%" />
          </div>
        </ion-item>
        <br>
    </div>
    </ion-list>
  </ion-content>
</ion-view>
